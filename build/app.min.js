var __awaiter=this&&this.__awaiter||function(e,s,i,l){return new(i=i||Promise)(function(t,a){function o(e){try{n(l.next(e))}catch(e){a(e)}}function d(e){try{n(l.throw(e))}catch(e){a(e)}}function n(e){var a;e.done?t(e.value):((a=e.value)instanceof i?a:new i(function(e){e(a)})).then(o,d)}n((l=l.apply(e,s||[])).next())})},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});let express_1=__importDefault(require("express")),db_1=__importDefault(require("./db")),PORT=3002,app=(0,express_1.default)(),dbName="CV_BK",collectionName="Resume",dataBase=(app.use(express_1.default.json()),new db_1.default);dataBase.MONGODB_URL="mongodb+srv://karthikeyanbalan:Dinner1234@bk.glsqe.mongodb.net",dataBase.dbName=dbName,dataBase.collectionName=collectionName,app.get("/",(e,a)=>__awaiter(void 0,void 0,void 0,function*(){dataBase.getDatabase({dbName:dbName,collectionName:collectionName,onUpdate:e=>{a.send({data:e.data})}})})),app.post("/add",(a,t)=>__awaiter(void 0,void 0,void 0,function*(){var e=(null==a?void 0:a.body)||{};a.body?dataBase.doUpdateDatabase({dbName:dbName,collectionName:collectionName,pushObjectData:e,onUpdate:e=>{t.json({message:"add successful",data:a.body})}}):t.status(400).send("Bad request")})),app.delete("/delete/:id",(e,a)=>{let t=e.params.id;console.log("Deleting record with id: "+t),dataBase.doDeleteDatabase({dbName:dbName,collectionName:collectionName,removeId:t,onUpdate:e=>{a.json({message:`Record with id ${t} deleted successfully`})}})}),app.listen(PORT,()=>{console.log("I am listening on port "+PORT)});